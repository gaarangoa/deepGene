import sys
import argparse
import json
from motif2json import main as motifToJsonMain
from mergerFeatures import main as mergeFeatures

def motif2json(args):
    motifToJsonMain(args.input, args.output)

def merger(args):
    mergeFeatures(args)

def main():
    parser = argparse.ArgumentParser(prog="deepGene", description="welcome to the amazing deepGene software")
    subparsers = parser.add_subparsers(help="type the command name for help", title="commands", description="valid subcomands")
    
    # parser for the motif2json utility
    motifToJsonParser = subparsers.add_parser('motif2json', description='This program takes the results from the motif finding and parses that file into a json file')
    motifToJsonParser.add_argument('--input', help='input motif generated by FIMO', required=True)
    motifToJsonParser.add_argument('--output', help="output json file", required=True)
    motifToJsonParser.set_defaults(func=motif2json)
    
    # merge features 
    mergerParser = subparsers.add_parser('mergeFeatures', help="merge different sets of features")
    mergerParser.add_argument('--features', nargs='+', help='List of feature files', required=True)
    # mergerParser.add_argument('--labels', help='File with labels of each gene', required=True)
    mergerParser.add_argument('--genes', help='File with gene ids that are considered for the analysis. If the file is empty all genes are used')
    mergerParser.add_argument('--output', help='output hdf5 format dataset', required=True)
    mergerParser.set_defaults(func=merger)

    # training module
    args = parser.parse_args()
    args.func(args)


